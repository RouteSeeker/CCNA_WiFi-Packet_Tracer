# Multi-VLAN Setup Lab

## Overview
This lab builds on the previous setup where we had a single WiFi VLAN servicing four different departments. Each LWAP (Lightweight Access Point) was assigned to a specific department. In this lab, we will create separate VLANs for each department: Accounts, Sales, Staff, and Guest, with each having its own VLAN.

## Objectives
- Create and configure four VLANs: Accounts, Sales, Staff, and Guest.
- Use a DHCP/AAA server for IP address assignment and authentication.
- Configure a router for inter-VLAN routing.
- Set up a Wireless LAN Controller (WLC) and three LWAPs.
- Assign each LWAP to broadcast multiple SSIDs, each corresponding to the four VLANs.

## Network Details
- **Management VLAN:** 192.168.99.0/24
- **Accounts VLAN (VLAN 10):** 192.168.10.0/24
- **Sales VLAN (VLAN 30):** 192.168.30.0/24
- **Staff VLAN (VLAN 40):** 192.168.40.0/24
- **Server Network:** 192.168.1.0/24

## Equipment and Topology
- **DHCP/AAA Server:** To provide IP addresses and authentication services.
- **Router:** To perform inter-VLAN routing.
- **Wireless LAN Controller (WLC):** To manage LWAPs.
- **3 LWAPs:** To provide wireless access to different VLANs.


![Initial Setup](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/01.Initial.PNG)


## Steps

### 1. VLAN Configuration
1. **Create VLANs on the Switch:**
   - VLAN 10: Accounts
   - VLAN 30: Sales
   - VLAN 40: Staff
   - VLAN 50: Guest
   - VLAN 99: Management

**SW1 config**
```
vlan 99
name Management 
vlan 10
name Accounts
vlan 30
name Sales
vlan 40
name Staff
vlan 50
name Guest

``` 
![Creating Vlans](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/02.Creating_Vlans.PNG)


2. **Assign Ports to VLANs:**
Next, I configured the switch ports connected to the LWAPs as trunk ports. I then assigned the appropriate VLANs to each port connected to the wired devices.
```
interface range fastEthernet 0/1 - 3,g0/1 - 2
switchport mode trunk
switchport trunk native vlan 99
```

![Show Trunk](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/03.Show_Trunk.PNG)

### 2. DHCP/AAA Server Configuration

1.**Set up DHCP Scopes for each VLAN:**
This step involves setting up the DHCP server to serve IP addresses to the four VLANs we configured earlier.

![DHCP Setup](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/05.DHCP_Pool_creation.PNG)

2. **Set up the AAA Service**
The next step involves configuring the AAA server with the WLC IP address and setting up various usernames that will be used for authentication.

![AAA Setup](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/05.AAA_Setup.PNG)

### 3. Router Configuration
**Configure Sub-Interfaces for Each VLAN:**

Next, I set up the four sub-interfaces on the router to enable communication between VLANs. I also configured a DHCP relay (helper address) to ensure the devices in each VLAN can find the DHCP server.
```
int gigabitEthernet 0/0/0
ip address 192.168.1.1 255.255.255.0
no shutdown

int gigabitEthernet 0/0/1
no shutdown
int gigabitEthernet 0/0/1.10
encapsulation dot1Q 10
ip address 192.168.10.1 255.255.255.0
ip helper-address 192.168.1.2

int gigabitEthernet 0/0/1.30
encapsulation dot1Q 30
ip address 192.168.30.1 255.255.255.0
ip helper-address 192.168.1.2
int gigabitEthernet 0/0/1.40
encapsulation dot1Q 40
ip address 192.168.40.1 255.255.255.0
ip helper-address 192.168.1.2
int gigabitEthernet 0/0/1.50
encapsulation dot1Q 50
ip address 192.168.50.1 255.255.255.0
ip helper-address 192.168.1.2

int gigabitEthernet 0/0/1.99
encapsulation dot1Q 99 native
ip address 192.168.99.1 255.255.255.0
ip helper-address 192.168.1.2
```

### 4. WLC Configuration
1. **Set up the Management Interface:**
The next step was to set up the WLC. After changing the default IP address on the management interface, I logged in using a PC to configure it. I then set up the first network, Accounts, and completed the initial setup.
![Initial WLC Setup](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/06.WLC_Initial_Config.PNG)
   

2. **Configure WLANs on the WLC:**
The next step was to set up the additional WLANs on the WLAN tab. On the General tab, I enabled each WLAN. In the Security tab, I changed the Layer 2 security settings to WPA+WPA2. I then checked the WPA Policy box and set WPA2 encryption to AES, as well as enabled the 802.1x checkbox.

![WLAN enable](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/07.Staff_Wlan_Enable.PNG)

![WLAN security](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/08.Staff_Wlan_Security.PNG)

Next, I selected the AAA server we configured earlier. Finally, on the Advanced tab, I checked both the FlexConnect Local Switching and FlexConnect Local Authentication checkboxes.

![Wlan AAA](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/09.Staff_Wlan_AAA.PNG)

![WLAN Advanced](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/10.Staff_Wlan_Advanced.PNG)

The same process was applied to the Staff WLAN. For the Guest Network, since it uses PSK instead of 802.1x, I selected the PSK checkbox and entered "Cisco@123" as the Guest password.
![Guest Password](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/11.Guest_PSK.PNG)

![All WLANs}(https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/12.All_Wlans.PNG)


3. **Create Interfacess:**

This step involved configuring the interfaces for each VLAN. It’s important to ensure that the port numbers correlate with those used on the WLC and that the IP addresses assigned do not conflict with each other. Additionally, make sure to specify the DHCP server IP address on each VLAN interface, including the management interface. I initially forgot this step and spent an excessive amount of time troubleshooting why the LWAPs weren’t receiving IP addresses.   

![Interface](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/13.Accounts_Interface_ID.PNG)

![Interface General](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/14.Accounts_Interface_General_Info.PNG)

![All Interfaces](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/15.All_Interfaces.PNG)


4. **WLAN Association:**

Since I began by creating the WLANs before setting up the interfaces, I now need to go back and associate each WLAN with its corresponding interface.

![WLAN Association](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/16.Wlan_Association.PNG)


### 5. Testing and Verification
This step involved changing the LWAPs from static IP addresses to DHCP so they could receive IP addresses automatically. I also configured the usernames and passwords on the AAA server for user authentication. Additionally, I set up the guest tablet using the pre-shared key.

And voila! We have a connection through all three LWAPs.

![All connected](https://github.com/RouteSeeker/CCNA_WiFi-Packet_Tracer/blob/main/assets/screenshots/multi-vlan/22.Connected_PCs.PNG)

In conclusion, the multi-VLAN network setup was successfully completed. We configured VLANs for Accounts, Sales, Staff, and Guest, ensuring proper IP assignment through DHCP and seamless communication between VLANs via the router. The WLC was set up to manage multiple WLANs, with security settings tailored to each network type. By adjusting the LWAPs to use DHCP and ensuring all configurations were correctly applied, we achieved full connectivity across all LWAPs, providing reliable network access and authentication for both wired and wireless clients. This setup effectively supports departmental segmentation and guest access, enhancing both security and network management.
